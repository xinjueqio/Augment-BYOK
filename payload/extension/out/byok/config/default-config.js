"use strict";

function defaultConfig() {
  return {
    version: 1,
    official: {
      completionUrl: "https://api.augmentcode.com/",
      apiToken: ""
    },
    historySummary: {
      enabled: false,
      providerId: "",
      model: "",
      maxTokens: 1024,
      timeoutSeconds: 60,
      triggerOnHistorySizeChars: 800000,
      triggerStrategy: "auto",
      triggerOnContextRatio: 0.7,
      targetContextRatio: 0.55,
      contextWindowTokensDefault: 0,
      contextWindowTokensOverrides: {},
      historyTailSizeCharsToExclude: 250000,
      minTailExchanges: 2,
      cacheTtlMs: 0,
      maxSummarizationInputChars: 250000,
      prompt: "You are performing a CONTEXT CHECKPOINT COMPACTION. Create a handoff summary for another LLM that will resume the task.\n\nInclude:\n- Current progress and key decisions made\n- Important context, constraints, or user preferences\n- What remains to be done (clear next steps)\n- Any critical data, examples, or references needed to continue\n\nBe concise, structured, and focused on helping the next LLM seamlessly continue the work.",
      rollingSummary: true,
      summaryNodeRequestMessageTemplate: "<supervisor>\nThis is a continuation of the conversation that Agent(you) had with the user.\n\nHere is the summary of whole conversation history that was generated by Agent(you) so 'I' in the summary represents Agent(you).\n<summary request_id=\"{summarization_request_id}\">\n{summary}\n</summary>\n\nThe whole previous conversation history was split into three parts:\n- beginning. Information from this part is only present in the compressed form in the summary above. This part is not shown neither in abridged nor in full form below to reduce context size. This part can be empty if the whole conversation was short enough.\n- middle. This part is present in the abridged form below.\n- end. This part is present in full form below.\n\nBeginning part has {beginning_part_dropped_num_exchanges} exchanges.\n\n<middle_part_abridged>\n{middle_part_abridged}\n</middle_part_abridged>\n\n<end_part_full>\n{end_part_full}\n</end_part_full>\n\nContinue the conversation and finish the task given by the user from this point.\n</supervisor>",
      abridgedHistoryParams: {
        totalCharsLimit: 10000,
        userMessageCharsLimit: 1000,
        agentResponseCharsLimit: 2000,
        actionCharsLimit: 200,
        numFilesModifiedLimit: 10,
        numFilesCreatedLimit: 10,
        numFilesDeletedLimit: 10,
        numFilesViewedLimit: 10,
        numTerminalCommandsLimit: 10
      }
    },
    providers: [
      {
        id: "openai",
        type: "openai_compatible",
        baseUrl: "https://api.openai.com/v1",
        apiKey: "",
        models: ["gpt-4o-mini"],
        defaultModel: "gpt-4o-mini",
        headers: {},
        requestDefaults: {}
      },
      {
        id: "anthropic",
        type: "anthropic",
        baseUrl: "https://api.anthropic.com/v1",
        apiKey: "",
        models: ["claude-3-5-sonnet-20241022"],
        defaultModel: "claude-3-5-sonnet-20241022",
        headers: {},
        requestDefaults: {}
      }
    ],
    routing: {
      rules: {
        /* BEGIN GENERATED: DEFAULT_LLM_ROUTING_RULES */
        "/get-models": { mode: "byok" },
        "/chat": { mode: "byok" },
        "/completion": { mode: "byok" },
        "/chat-input-completion": { mode: "byok" },
        "/edit": { mode: "byok" },
        "/next_edit_loc": { mode: "byok" },
        "/chat-stream": { mode: "byok" },
        "/prompt-enhancer": { mode: "byok" },
        "/instruction-stream": { mode: "byok" },
        "/smart-paste-stream": { mode: "byok" },
        "/next-edit-stream": { mode: "byok" },
        "/generate-commit-message-stream": { mode: "byok" },
        "/generate-conversation-title": { mode: "byok" },
        /* END GENERATED: DEFAULT_LLM_ROUTING_RULES */

        "/user-secrets/list": { mode: "disabled" },
        "/user-secrets/upsert": { mode: "disabled" },
        "/user-secrets/delete": { mode: "disabled" },

        "/client-metrics": { mode: "disabled" },
        "/client-completion-timelines": { mode: "disabled" },
        "/record-preference-sample": { mode: "disabled" },
        "/record-request-events": { mode: "official" },
        "/record-session-events": { mode: "disabled" },
        "/record-user-events": { mode: "disabled" },
        "/report-error": { mode: "official" },
        "/resolve-completions": { mode: "disabled" },
        "/resolve-edit": { mode: "disabled" },
        "/resolve-instruction": { mode: "disabled" }
      }
    }
  };
}

module.exports = { defaultConfig };
